<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Gyors szelvény bevitel</title>
    <style>
        body { font-family: Arial; padding: 20px; background-color: #f9f9f9; }
        input, button, label, select { margin: 5px; padding: 5px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #999; padding: 8px; text-align: left; }
        th { background-color: #555; color: white; }
        tr:nth-child(even) { background-color: #eee; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <h1>Gyors szelvény bevitel</h1>

    <label>Sportág:</label>
    <select id="sport">
        <option value="Krikett">Krikett</option>
        <option value="Tenisz">Tenisz</option>
        <option value="Esport">Esport</option>
        <option value="Kosárlabda">Kosárlabda</option>
        <option value="Labdarúgás">Labdarúgás</option>
        <option value="Jégkorong">Jégkorong</option>
        <option value="MIX">MIX</option>
    </select>

    <label>Dátum (ÉÉÉÉMMDD):</label>
    <input type="text" id="date" placeholder="20230101" maxlength="8" oninput="formatDate(this)">

    <label>Mérkőzés 1 / Csapatok:</label>
    <input type="text" id="match1" placeholder="Pl. Kenya-Ruanda">

    <label>
        <input type="checkbox" id="isCombo" onchange="toggleCombo()"> Kötés (több mérkőzés)
    </label>

    <div id="comboFields" class="hidden">
        <label>Mérkőzés 2 / Csapatok:</label>
        <input type="text" id="match2" placeholder="Pl. Uganda-Tanzánia">
    </div>

    <label>Teljes odds:</label>
    <input type="number" id="odds" step="0.01" placeholder="2.5">

    <label>Tét (Ft):</label>
    <input type="number" id="stake" placeholder="50000">

    <label>GYŐZTES:</label>
    <input type="text" id="winner" placeholder="Pl. Kenya">

    <button onclick="addBet()">Hozzáad a táblázathoz</button>
    <button onclick="exportCSV()">CSV mentés</button>

    <table id="table">
        <thead>
            <tr>
                <th>Sportág</th>
                <th>Dátum</th>
                <th>Mérkőzés 1</th>
                <th>Mérkőzés 2 (kötés)</th>
                <th>Kötés?</th>
                <th>Teljes odds</th>
                <th>Tét (Ft)</th>
                <th>GYŐZTES</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        const bets = []; // ide tároljuk az összes szelvényt

        function toggleCombo(){
            const comboFields = document.getElementById('comboFields');
            comboFields.classList.toggle('hidden');
        }

        function formatDate(input){
            input.value = input.value.replace(/\D/g,''); // csak szám
            if(input.value.length > 8) input.value = input.value.slice(0,8);
        }

        function addBet(){
            const sport = document.getElementById('sport').value;
            const dateInput = document.getElementById('date').value.trim();
            const match1 = document.getElementById('match1').value.trim();
            const match2 = document.getElementById('match2').value.trim();
            const odds = document.getElementById('odds').value.trim();
            const stake = document.getElementById('stake').value.trim();
            const winner = document.getElementById('winner').value.trim();
            const isCombo = document.getElementById('isCombo').checked ? "Igen" : "Nem";

            if(!match1 || !odds || !stake || dateInput.length !== 8){
                alert("Kérlek töltsd ki a sportágat, dátumot (8 számjegy), az első mérkőzést, odds-ot és tétet!");
                return;
            }

            const formattedDate = dateInput.slice(0,4) + '.' + dateInput.slice(4,6) + '.' + dateInput.slice(6,8);

            // Új szelvény objektum
            const bet = {
                sport, 
                date: dateInput, // szám formátumban tároljuk a rendezéshez
                formattedDate,
                match1,
                match2,
                isCombo,
                odds,
                stake,
                winner
            };

            bets.push(bet);

            // Rendezés dátum szerint növekvő
            bets.sort((a,b) => a.date - b.date);

            // Táblázat újraépítése
            const tbody = document.querySelector('#table tbody');
            tbody.innerHTML = '';
            bets.forEach(b=>{
                const tr = document.createElement('tr');
                [b.sport, b.formattedDate, b.match1, b.match2, b.isCombo, b.odds, b.stake, b.winner].forEach(v=>{
                    const td = document.createElement('td');
                    td.textContent = v;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            // Reset mezők
            document.getElementById('date').value = '';
            document.getElementById('match1').value = '';
            document.getElementById('match2').value = '';
            document.getElementById('odds').value = '';
            document.getElementById('stake').value = '';
            document.getElementById('winner').value = '';
            document.getElementById('isCombo').checked = false;
            document.getElementById('comboFields').classList.add('hidden');
        }

        function exportCSV(){
            const rows = [];
            const table = document.querySelector('#table');
            for(let r of table.rows){
                const cols = Array.from(r.cells).map(c => c.textContent.replace(/,/g, ''));
                rows.push(cols.join(','));
            }
            const csvContent = rows.join('\n');
            const blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'szelvenyek.csv';
            link.click();
        }
    </script>
</body>
</html>
